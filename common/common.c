/*******************************************************************************
*
* FILE: 
* 		common.c
*
* DESCRIPTION: 
* 		Contains utility functions for SDR code.
*
*******************************************************************************/


/*------------------------------------------------------------------------------
 Standard Includes                                                                     
------------------------------------------------------------------------------*/


/*------------------------------------------------------------------------------
 Project Includes                                                                     
------------------------------------------------------------------------------*/
#include "main.h"
#include "common.h"
#include "sdr_error.h"
#include "stm32h7xx_hal.h"


/*------------------------------------------------------------------------------
 Global Variables  
------------------------------------------------------------------------------*/


/*------------------------------------------------------------------------------
 Internal function prototypes 
------------------------------------------------------------------------------*/


/*------------------------------------------------------------------------------
 API Functions 
------------------------------------------------------------------------------*/

/*******************************************************************************
*                                                                              *
* PROCEDURE:                                                                   * 
* 		crc32                                                                  *
*                                                                              *
* DESCRIPTION:                                                                 * 
* 		Returns a 32bit checksum from the given data.                          *
*                                                                              *
*******************************************************************************/
uint32_t crc32
    (
    const uint8_t *data, 
    size_t len
    ) 
{
uint32_t crc = 0xFFFFFFFF;
while (len--) 
    {
    crc ^= *data++;
    for (int i = 0; i < 8; ++i)
        crc = (crc >> 1) ^ (0xEDB88320 & -(crc & 1));
    }
return ~crc;

} /* crc32 */


/*******************************************************************************
*                                                                              *
* PROCEDURE:                                                                   * 
* 		error_fail_fast                                                        *
*                                                                              *
* DESCRIPTION:                                                                 * 
* 		In case of error occurrence, this function passes the error            *
*       code to the error handler                                              *
*                                                                              *
*******************************************************************************/
void error_fail_fast
    (
    volatile ERROR_CODE error_code
    )
{
Error_Handler(error_code);

} /* error_fail_fast */


/*******************************************************************************
*                                                                              *
* PROCEDURE:                                                                   * 
* 		delay_ms                                                               *
*                                                                              *
* DESCRIPTION:                                                                 * 
* 		Minimum delay in miliseconds                                           *
*                                                                              *
*******************************************************************************/
void delay_ms
    (
    uint32_t delay
    )
{
HAL_Delay(delay);

} /* delay_ms */

/*******************************************************************************
* END OF FILE                                                                  * 
*******************************************************************************/